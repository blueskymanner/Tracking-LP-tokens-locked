{"ast":null,"code":"import React, { useEffect, useState } from \"react\";\nimport { ethers } from \"ethers\";\nimport unicryptETHabi from \"../abi/unicryptETH_abi.json\";\nimport uniswapETHabi from \"../abi/uniswapETH_abi.json\";\nimport BigNumber from \"bignumber.js\";\nimport { createClient } from 'urql';\nimport Axios from \"axios\";\nconst unicryptAddressETH = \"0x663A5C229c09b049E36dCc11a9B0d4a8Eb9db214\"; // const unicryptAddressBSC = \"0xC765bddB93b0D1c1A88282BA0fa6B2d00E3e0c83\";\n\nasync function UnicryptETH() {\n  let provider = ethers.getDefaultProvider();\n  const unicryptETHPortal = new ethers.Contract(unicryptAddressETH, unicryptETHabi, provider);\n  let total_tokenNums = await unicryptETHPortal.getNumLockedTokens();\n  const APIURL = 'https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v2';\n  const ethpriceQuery = `\n      query {\n        bundle(id: \"1\" ) {\n          ethPrice\n        }\n      }\n    `;\n  const client = createClient({\n    url: APIURL\n  });\n  const ethData = await client.query(ethpriceQuery).toPromise();\n  let ethPrice = ethData.data.bundle.ethPrice;\n  let tokenAddr = [];\n  const uniswapETHPortal = [];\n  let token0Addr = [];\n  let token1Addr = [];\n  let LPdecimals = [];\n  const tokensQuery0 = [];\n  const tokensQuery1 = [];\n  const tokenData0 = [];\n  let decimals0 = [];\n  let token0Symbol = [];\n  let token0DerivedETH = [];\n  const tokenData1 = [];\n  let decimals1 = [];\n  let token1Symbol = [];\n  let token1DerivedETH = [];\n  let tokenReserves = [];\n  let token0Reserve = [];\n  let token1Reserve = [];\n  let tokenLockdata = [];\n  let lockedAmount = [];\n  let total_supply = [];\n  let totalSupply = [];\n  let percentage = [];\n  let percent = [];\n  let token0Price = [];\n  let token1Price = [];\n  let LPmarketcap = [];\n  let lockedPrice = [];\n  let lockDate = [];\n  let unlockDate = [];\n  let period = [];\n  let score = [];\n  let tokensinfo = [];\n\n  for (let i = 0; i < 10; i++) {\n    tokenAddr[i] = await unicryptETHPortal.getLockedTokenAtIndex(total_tokenNums - i - 1);\n    uniswapETHPortal[i] = new ethers.Contract(tokenAddr[i], uniswapETHabi, provider);\n    token0Addr[i] = await uniswapETHPortal[i].token0();\n    token1Addr[i] = await uniswapETHPortal[i].token1();\n    LPdecimals[i] = await uniswapETHPortal[i].decimals(); // let apiurl = `https://api.coingecko.com/api/v3/coins/ethereum/contract/${token1Addr}`;\n    // const { data: datainfo } = await Axios.get(apiurl);\n    // console.log(datainfo.market_data.current_price.usd);\n\n    tokensQuery0[i] = `\n        query {\n          token(id: \"${token0Addr[i].toLowerCase()}\"){\n            symbol\n            decimals\n            derivedETH\n          }\n        }\n      `;\n    tokensQuery1[i] = `\n        query {\n          token(id: \"${token1Addr[i].toLowerCase()}\"){\n            symbol\n            decimals\n            derivedETH\n          }\n        }\n      `;\n    tokenData0[i] = await client.query(tokensQuery0[i]).toPromise();\n    decimals0[i] = tokenData0[i].data.token.decimals;\n    token0Symbol[i] = tokenData0[i].data.token.symbol;\n    token0DerivedETH[i] = tokenData0[i].data.token.derivedETH;\n    tokenData1[i] = await client.query(tokensQuery1[i]).toPromise();\n    decimals1[i] = tokenData1[i].data.token.decimals;\n    token1Symbol[i] = tokenData1[i].data.token.symbol;\n    token1DerivedETH[i] = tokenData1[i].data.token.derivedETH;\n    tokenReserves[i] = await uniswapETHPortal[i].getReserves();\n    token0Reserve[i] = new BigNumber(tokenReserves[i][0]._hex).dividedBy(new BigNumber(10).pow(decimals0[i]));\n    token1Reserve[i] = new BigNumber(tokenReserves[i][1]._hex).dividedBy(new BigNumber(10).pow(decimals1[i]));\n    tokenLockdata[i] = await unicryptETHPortal.tokenLocks(tokenAddr[i], 0);\n    lockedAmount[i] = new BigNumber(tokenLockdata[i][1]._hex).dividedBy(new BigNumber(10).pow(LPdecimals[i]));\n    total_supply[i] = await uniswapETHPortal[i].totalSupply();\n    totalSupply[i] = new BigNumber(total_supply[i]._hex).dividedBy(new BigNumber(10).pow(LPdecimals[i]));\n    percentage[i] = lockedAmount[i].dividedBy(totalSupply[i]);\n    percent[i] = percentage[i].multipliedBy(new BigNumber(100)).toFormat(1);\n    token0Price[i] = token0Reserve[i].multipliedBy(new BigNumber(token0DerivedETH[i])).multipliedBy(new BigNumber(ethPrice));\n    token1Price[i] = token1Reserve[i].multipliedBy(new BigNumber(token1DerivedETH[i])).multipliedBy(new BigNumber(ethPrice));\n    LPmarketcap[i] = token0Price[i].plus(token1Price[i]);\n    lockedPrice[i] = LPmarketcap[i].multipliedBy(percentage[i]);\n    lockDate[i] = new BigNumber(tokenLockdata[i][0]._hex);\n    unlockDate[i] = new BigNumber(tokenLockdata[i][3]._hex);\n    period[i] = unlockDate[i].minus(lockDate[i]).dividedBy(new BigNumber(86400));\n    score[i] = lockedPrice[i].multipliedBy(period[i]).multipliedBy(percentage[i]).toFormat(0);\n    tokensinfo.push({\n      tokenName: token0Symbol[i] + \" / \" + token1Symbol[i],\n      blockchain: \"Ethereum\",\n      lockedPrice: \"$\" + lockedPrice[i].toFormat(0),\n      lockedAmount: lockedAmount[i].toFormat(4) + \" (\" + percent[i] + \"%)\",\n      unlockPeriod: period[i].toFormat(0) + \"days\",\n      locker: \"Unicrypt\",\n      marketCap: \"$\" + LPmarketcap[i].toFormat(0),\n      rank: \" \",\n      score: score[i]\n    });\n  }\n\n  return tokensinfo;\n}\n\n_c = UnicryptETH;\nexport default UnicryptETH; // import React, {useEffect, useState} from \"react\";\n// import { ethers } from \"ethers\";\n// import unicryptETHabi from \"../abi/unicrypt_abi.json\";\n//     const unicryptAddressETH = \"0x663A5C229c09b049E36dCc11a9B0d4a8Eb9db214\";\n//     const get_gFees = async () => {\n//         let provider = ethers.getDefaultProvider();\n//         const gFeesPortal = new ethers.Contract(unicryptAddressETH, unicryptETHabi, provider);\n//         const gFees = await gFeesPortal.getNumLockedTokens();\n//         return gFees;\n//     }\n// export default get_gFees;\n\nvar _c;\n\n$RefreshReg$(_c, \"UnicryptETH\");","map":{"version":3,"sources":["D:/My Data/backup/GIT/Tracking-LP-tokens-locked/src/Table/getdata.js"],"names":["React","useEffect","useState","ethers","unicryptETHabi","uniswapETHabi","BigNumber","createClient","Axios","unicryptAddressETH","UnicryptETH","provider","getDefaultProvider","unicryptETHPortal","Contract","total_tokenNums","getNumLockedTokens","APIURL","ethpriceQuery","client","url","ethData","query","toPromise","ethPrice","data","bundle","tokenAddr","uniswapETHPortal","token0Addr","token1Addr","LPdecimals","tokensQuery0","tokensQuery1","tokenData0","decimals0","token0Symbol","token0DerivedETH","tokenData1","decimals1","token1Symbol","token1DerivedETH","tokenReserves","token0Reserve","token1Reserve","tokenLockdata","lockedAmount","total_supply","totalSupply","percentage","percent","token0Price","token1Price","LPmarketcap","lockedPrice","lockDate","unlockDate","period","score","tokensinfo","i","getLockedTokenAtIndex","token0","token1","decimals","toLowerCase","token","symbol","derivedETH","getReserves","_hex","dividedBy","pow","tokenLocks","multipliedBy","toFormat","plus","minus","push","tokenName","blockchain","unlockPeriod","locker","marketCap","rank"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport unicryptETHabi from \"../abi/unicryptETH_abi.json\";\r\nimport uniswapETHabi from \"../abi/uniswapETH_abi.json\";\r\nimport BigNumber from \"bignumber.js\";\r\nimport { createClient } from 'urql'\r\nimport Axios from \"axios\";\r\n\r\nconst unicryptAddressETH = \"0x663A5C229c09b049E36dCc11a9B0d4a8Eb9db214\";\r\n// const unicryptAddressBSC = \"0xC765bddB93b0D1c1A88282BA0fa6B2d00E3e0c83\";\r\n\r\nasync function UnicryptETH() {\r\n  \r\n    let provider = ethers.getDefaultProvider();\r\n    const unicryptETHPortal = new ethers.Contract(unicryptAddressETH, unicryptETHabi, provider);\r\n    let total_tokenNums = await unicryptETHPortal.getNumLockedTokens();\r\n  \r\n    const APIURL = 'https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v2';\r\n    const ethpriceQuery = `\r\n      query {\r\n        bundle(id: \"1\" ) {\r\n          ethPrice\r\n        }\r\n      }\r\n    `; \r\n    const client = createClient({\r\n      url: APIURL,\r\n    });\r\n    const ethData = await client.query(ethpriceQuery).toPromise();\r\n    let ethPrice = ethData.data.bundle.ethPrice;\r\n  \r\n    let tokenAddr = [];\r\n    const uniswapETHPortal = [];\r\n    let token0Addr = [];\r\n    let token1Addr = [];\r\n    let LPdecimals = [];\r\n    const tokensQuery0 = [];\r\n    const tokensQuery1 = [];\r\n    const tokenData0 = [];\r\n    let decimals0 = [];\r\n    let token0Symbol = [];\r\n    let token0DerivedETH = [];\r\n    const tokenData1 = [];\r\n    let decimals1 = [];\r\n    let token1Symbol = [];\r\n    let token1DerivedETH = [];\r\n    let tokenReserves = [];\r\n    let token0Reserve = [];\r\n    let token1Reserve = [];\r\n    let tokenLockdata = [];\r\n    let lockedAmount = [];\r\n    let total_supply = [];\r\n    let totalSupply = [];\r\n    let percentage = [];\r\n    let percent = [];\r\n    let token0Price = [];\r\n    let token1Price = [];\r\n    let LPmarketcap = [];\r\n    let lockedPrice = [];\r\n    let lockDate = [];\r\n    let unlockDate = [];\r\n    let period = [];\r\n    let score = [];\r\n  \r\n    let tokensinfo = [];\r\n  \r\n    for (let i = 0; i < 10; i++) {\r\n      tokenAddr[i] = await unicryptETHPortal.getLockedTokenAtIndex(total_tokenNums - i - 1);\r\n  \r\n      uniswapETHPortal[i] = new ethers.Contract(tokenAddr[i], uniswapETHabi, provider);\r\n      token0Addr[i] = await uniswapETHPortal[i].token0();\r\n      token1Addr[i] = await uniswapETHPortal[i].token1();\r\n      LPdecimals[i] = await uniswapETHPortal[i].decimals();\r\n  \r\n      // let apiurl = `https://api.coingecko.com/api/v3/coins/ethereum/contract/${token1Addr}`;\r\n      // const { data: datainfo } = await Axios.get(apiurl);\r\n      // console.log(datainfo.market_data.current_price.usd);\r\n  \r\n      tokensQuery0[i] = `\r\n        query {\r\n          token(id: \"${token0Addr[i].toLowerCase()}\"){\r\n            symbol\r\n            decimals\r\n            derivedETH\r\n          }\r\n        }\r\n      `;\r\n      tokensQuery1[i] = `\r\n        query {\r\n          token(id: \"${token1Addr[i].toLowerCase()}\"){\r\n            symbol\r\n            decimals\r\n            derivedETH\r\n          }\r\n        }\r\n      `;\r\n  \r\n      tokenData0[i] = await client.query(tokensQuery0[i]).toPromise();\r\n      decimals0[i] = tokenData0[i].data.token.decimals;\r\n      token0Symbol[i] = tokenData0[i].data.token.symbol;\r\n      token0DerivedETH[i] = tokenData0[i].data.token.derivedETH;\r\n  \r\n      tokenData1[i] = await client.query(tokensQuery1[i]).toPromise();\r\n      decimals1[i] = tokenData1[i].data.token.decimals;\r\n      token1Symbol[i] = tokenData1[i].data.token.symbol;\r\n      token1DerivedETH[i] = tokenData1[i].data.token.derivedETH;\r\n      \r\n      tokenReserves[i] = await uniswapETHPortal[i].getReserves();\r\n      token0Reserve[i] = new BigNumber(tokenReserves[i][0]._hex).dividedBy(new BigNumber(10).pow(decimals0[i]));\r\n      token1Reserve[i] = new BigNumber(tokenReserves[i][1]._hex).dividedBy(new BigNumber(10).pow(decimals1[i]));\r\n  \r\n      tokenLockdata[i] = await unicryptETHPortal.tokenLocks(tokenAddr[i], 0);\r\n      lockedAmount[i] = new BigNumber(tokenLockdata[i][1]._hex).dividedBy(new BigNumber(10).pow(LPdecimals[i]));\r\n  \r\n      total_supply[i] = await uniswapETHPortal[i].totalSupply();\r\n      totalSupply[i] = new BigNumber(total_supply[i]._hex).dividedBy(new BigNumber(10).pow(LPdecimals[i]));\r\n  \r\n      percentage[i] = lockedAmount[i].dividedBy(totalSupply[i]);\r\n      percent[i] = percentage[i].multipliedBy(new BigNumber(100)).toFormat(1);\r\n  \r\n      token0Price[i] = token0Reserve[i].multipliedBy(new BigNumber(token0DerivedETH[i])).multipliedBy(new BigNumber(ethPrice));\r\n      token1Price[i] = token1Reserve[i].multipliedBy(new BigNumber(token1DerivedETH[i])).multipliedBy(new BigNumber(ethPrice));\r\n      LPmarketcap[i] = token0Price[i].plus(token1Price[i]);\r\n      lockedPrice[i] = LPmarketcap[i].multipliedBy(percentage[i]);\r\n  \r\n      lockDate[i] = new BigNumber(tokenLockdata[i][0]._hex);\r\n      unlockDate[i] = new BigNumber(tokenLockdata[i][3]._hex);\r\n      period[i] = unlockDate[i].minus(lockDate[i]).dividedBy(new BigNumber(86400));\r\n  \r\n      score[i] = lockedPrice[i].multipliedBy(period[i]).multipliedBy(percentage[i]).toFormat(0);\r\n  \r\n      tokensinfo.push({ tokenName: token0Symbol[i] + \" / \" + token1Symbol[i], \r\n                        blockchain: \"Ethereum\",\r\n                        lockedPrice: \"$\" + lockedPrice[i].toFormat(0), \r\n                        lockedAmount: lockedAmount[i].toFormat(4) + \" (\" + percent[i] + \"%)\", \r\n                        unlockPeriod: period[i].toFormat(0) + \"days\", \r\n                        locker: \"Unicrypt\", \r\n                        marketCap: \"$\" + LPmarketcap[i].toFormat(0), \r\n                        rank: \" \", \r\n                        score: score[i] });\r\n    }\r\n  \r\n    return tokensinfo;\r\n  }\r\n\r\nexport default UnicryptETH;\r\n\r\n\r\n\r\n\r\n// import React, {useEffect, useState} from \"react\";\r\n// import { ethers } from \"ethers\";\r\n// import unicryptETHabi from \"../abi/unicrypt_abi.json\";\r\n\r\n//     const unicryptAddressETH = \"0x663A5C229c09b049E36dCc11a9B0d4a8Eb9db214\";\r\n\r\n//     const get_gFees = async () => {\r\n//         let provider = ethers.getDefaultProvider();\r\n\r\n//         const gFeesPortal = new ethers.Contract(unicryptAddressETH, unicryptETHabi, provider);\r\n\r\n//         const gFees = await gFeesPortal.getNumLockedTokens();\r\n        \r\n//         return gFees;\r\n//     }\r\n\r\n\r\n// export default get_gFees;"]},"metadata":{},"sourceType":"module"}